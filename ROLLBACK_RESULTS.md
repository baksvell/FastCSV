# Результаты отката изменений для файлов с кавычками

## Примененные изменения

1. **Откат оптимизации поиска ближайшего символа**
   - Вернул предыдущую логику сравнения позиций кавычек и newline
   - Убрал оптимизацию с прямым указателем

2. **Откат оптимизации создания string_view**
   - Вернул промежуточную переменную для string_view

3. **Откат уменьшения порогов SIMD**
   - Вернул порог с 48 до 64 байт для batch обработки
   - Вернул порог с 24 до 32 байт для внутреннего поиска

4. **Сохранены исправления для файлов без кавычек**
   - Резервирование результатов для файлов без кавычек сохранено

## Результаты бенчмарков

### Улучшения ✅

#### Small (100 rows)
- **До отката**: 1.79x быстрее
- **После отката**: 1.53x быстрее
- **Изменение**: Небольшое ухудшение, но все еще лучше чем исходная регрессия (1.35x медленнее)

#### Medium (1000 rows)
- **До отката**: 1.18x быстрее
- **После отката**: 1.47x быстрее ✅
- **Изменение**: Значительное улучшение! Вернулось к хорошему результату

#### Large (10000 rows)
- **До отката**: 7.79x быстрее
- **После отката**: 8.47x быстрее ✅
- **Изменение**: Улучшение! Лучший результат

### Файлы с кавычками

#### Medium with quotes
- **До отката**: 1.16x медленнее
- **После отката**: 1.07x медленнее
- **Изменение**: Улучшение, но все еще хуже чем было (1.01x быстрее)

#### Medium with unicode
- **До отката**: 1.02x медленнее
- **После отката**: 1.01x медленнее
- **Изменение**: Небольшое улучшение, но все еще хуже чем было (1.11x быстрее)

## Анализ

### Успешные результаты ✅
1. **Medium (1000 rows)**: Вернулось к отличному результату (1.47x быстрее)
2. **Large (10000 rows)**: Лучший результат (8.47x быстрее)
3. **Small (100 rows)**: Хороший результат (1.53x быстрее)

### Файлы с кавычками
1. **Medium with quotes**: 1.07x медленнее - лучше чем было после исправления регрессий (1.16x), но хуже чем было до исправления регрессий (1.01x быстрее)
2. **Medium with unicode**: 1.01x медленнее - лучше чем было после исправления регрессий (1.02x), но хуже чем было до исправления регрессий (1.11x быстрее)

## Выводы

1. **Откат помог восстановить производительность для файлов без кавычек** ✅
   - Medium (1000 rows): 1.47x быстрее
   - Large (10000 rows): 8.47x быстрее
   - Small (100 rows): 1.53x быстрее

2. **Файлы с кавычками все еще медленнее, чем были до исправления регрессий**
   - Medium with quotes: 1.07x медленнее (было 1.01x быстрее)
   - Medium with unicode: 1.01x медленнее (было 1.11x быстрее)

3. **Возможная причина**: Резервирование для файлов без кавычек могло как-то повлиять на общую производительность

## Рекомендации

### Вариант 1: Принять текущие результаты ✅
- Файлы без кавычек показывают отличные результаты
- Файлы с кавычками показывают приемлемые результаты (1.07x и 1.01x медленнее)

### Вариант 2: Дополнительная оптимизация
- Проанализировать, почему резервирование для файлов без кавычек могло повлиять на файлы с кавычками
- Попробовать оптимизировать резервирование для файлов с кавычками отдельно

### Вариант 3: Эксперименты
- Попробовать разные варианты резервирования
- Профилирование для выявления узких мест



