# Анализ проблемы Small (10 rows)

## Проблема

Small (10 rows): **1.60x-1.62x медленнее** стандартного csv
- Размер файла: **~1450 байт** (<3KB)
- Порог fallback: **3KB (3072 байт)**
- Файл должен попадать в fallback, но результат не улучшился

## Анализ кода

1. **Инициализация**: `_file_size_checked = False` в `__init__`
2. **Вызов**: `_check_and_parse_small_file()` вызывается в `__next__` если `not self._file_size_checked`
3. **Fallback**: Для файлов <3KB должен использоваться `std_csv.reader`

## Возможные причины

1. **Исключение в fallback**: Возможно, `std_csv.reader` выбрасывает исключение, которое перехватывается
2. **Файл обрабатывается другим путем**: Возможно, файл обрабатывается до вызова `_check_and_parse_small_file`
3. **Проблема с `dialect` или `fmtparams`**: Возможно, передача параметров вызывает проблему
4. **Overhead инициализации**: Возможно, даже fallback имеет overhead из-за создания StringIO

## Решения

1. **Упростить fallback**: Использовать минимальные параметры
2. **Увеличить порог**: Попробовать 5KB или 10KB
3. **Проверить логику**: Убедиться, что файл действительно попадает в fallback
4. **Альтернативный подход**: Для очень маленьких файлов (<1KB) вообще не использовать FastCSV

## Рекомендации

Для очень маленьких файлов (10 строк) overhead инициализации FastCSV может быть слишком большим, даже с fallback. Возможно, стоит:
- Принять текущий результат как приемлемый (1.6x медленнее для очень маленьких файлов)
- Или увеличить порог fallback до 5KB-10KB
- Или использовать другой подход - полностью пропускать FastCSV для файлов <1KB




