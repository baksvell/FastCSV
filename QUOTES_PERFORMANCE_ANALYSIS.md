# Анализ производительности файлов с кавычками

## Проблема

Medium with quotes (1000 rows): **3.08x медленнее** стандартного csv (1.71ms -> 5.28ms)

## Возможные причины

### 1. Проверка `has_unclosed_quotes`
- Вызывается для каждого чанка
- Может быть медленной для больших файлов
- Если возвращает True, используется построчное чтение вместо batch

### 2. Построчное чтение вместо batch
- Для файлов с незакрытыми кавычками используется построчное чтение
- Это добавляет overhead Python-C++ вызовов
- Каждая строка парсится отдельно

### 3. Путь обработки в `parse_line_quotes_no_escape`
- Может быть медленнее чем ожидалось
- SIMD может не использоваться эффективно
- Много проверок и ветвлений

## План диагностики

1. Проверить, используется ли batch обработка для файлов с кавычками
2. Проверить производительность `has_unclosed_quotes`
3. Проверить, сколько раз вызывается `parse_line_quotes_no_escape`
4. Сравнить с файлами без кавычек

## Возможные решения

1. Оптимизировать `has_unclosed_quotes` - использовать SIMD
2. Улучшить batch обработку для файлов с кавычками (но это уже пробовали)
3. Оптимизировать `parse_line_quotes_no_escape` - уменьшить проверки
4. Использовать другой алгоритм для файлов с кавычками




